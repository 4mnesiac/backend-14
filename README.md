# Backend 14. Authorization. Security

### Описание

Яндекс Практикум, 14 спринт. Реализация авторизации и аутентификации. Безопасность веб-приложений.

### Развертывание

Развертывание с помощью скрипта **start**.

```bash
npm run start
```

Для отладки и внесения изменений используется режим **dev** с "hot reload".

```bash
npm run dev
```

Приложение подключается к серверу Mongo по адресу

```bash
mongodb://localhost:27017/mestodb
```

### Версии

**v.1.0.0** - инициализация проекта

**v.1.0.1** - внесены следующие изменения:

+ Добавлен email и password к схеме пользователя

+ Переработан контроллер createUser

+ Новый контроллер login

+ Новые роуты для авторизации и регистрации `/signin`, `/signup`

+ Добавлен мидлвэр для авторизации

+ Реализована защита API

+ Удален хардкод авторизации

+ Пользователи не могут редактировать чужие профили

+ API не возвращает хеш пароля

**v.1.0.2** - внесены следующие необязательные дополнения:

+ подключен модуль ``helmet`` для проставления заголовков безопасности 

+ проведен аудит безопасности, исправлены уязвимости пакета ``loadash``

**v.1.0.3** - внесены следующие исправления:

+ убрано ограничение уникальности на поле password;

+ исправлена ошибка порта;

+ авторизация реализована через Cookie;

+ обновлен метод регистрации: API не возвращает пароль, добавлен модуль ``mongoose-unique-validator``;

+ удален модуль ``crypto``;

+ JWT секреты вынесены во внешний файл

+ обновлена валидация аватара;

+ Изменен вывод ошибки CastError;

**v.1.0.4** - внесены изменения:

+ обновлена мидлвэра ``auth``;

+ повторная регистрация на тот же ``email`` возвращает корректную ошибку;

+ исправлена ошибка development-среды;

+ исправлена ошибка регистрации без пароля;

+ обновлен метод обновления профиля;

+ теперь при отсутствии прав пользователя возвращается корректная ошибка;

+ проработан вывод кастомных ошибок ``CastError`` и ``AuthError``.

**v.1.0.5** - внесены изменения:

+ добавлена дополнительная проверка к методу регистрации пользователя;

+ обновлена проверка при создании пользователя;

+ обновлен метод обновления профиля
